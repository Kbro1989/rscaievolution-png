name = "rsc-server-do"
main = "index.js"
compatibility_date = "2024-11-28"
compatibility_flags = [ "nodejs_compat" ]

[[rules]]
type = "Data"
globs = ["**/*.jag", "**/*.mem"]
fallthrough = false

# KV Namespace binding (same as Pages project)
[[kv_namespaces]]
binding = "KV"
id = "88142cf6969b4547ab17f2d97f6249a1"

# Durable Object binding
[[durable_objects.bindings]]
name = "RSC_SERVER"
class_name = "RSCServerDO"

[[durable_objects.bindings]]
name = "PLAYER_DO"
class_name = "PlayerDO"

# D1 Binding for Event Sourcing
[[d1_databases]]
binding = "DB"
database_name = "ai-architect-db"
database_id = "e8cea666-e70f-43e4-9a5e-54fd7fc80fa4"

# Durable Object migration
[[migrations]]
tag = "v1"
new_sqlite_classes = ["RSCServerDO", "PlayerDO"]
