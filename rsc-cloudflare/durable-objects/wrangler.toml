name = "rsc-server-do"
main = "index.js"
compatibility_date = "2024-11-28"
compatibility_flags = [ "nodejs_compat" ]

[[rules]]
type = "Data"
globs = ["**/*.jag", "**/*.mem"]
fallthrough = false

# KV Namespace binding (same as Pages project)
[[kv_namespaces]]
binding = "KV"
id = "88142cf6969b4547ab17f2d97f6249a1"

# Durable Object binding
[[durable_objects.bindings]]
name = "RSC_SERVER"
class_name = "RSCServerDO"

[[durable_objects.bindings]]
name = "PLAYER_DO"
class_name = "PlayerDO"

# D1 Binding for Event Sourcing
[[d1_databases]]
binding = "DB"
database_name = "ai-architect-db"
database_id = "d021ab5b-ab13-47b8-9287-1aabebfe51df"

# Durable Object migration
[[migrations]]
tag = "v1"
new_classes = ["RSCServerDO"]

[[migrations]]
tag = "v2"
new_classes = ["PlayerDO"]
